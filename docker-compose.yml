name: BUILD
on:
  push:
    #tags:
    #  - "*"
    branches:
    - feature/ci-test

env:
  BUNDLER_VERSION: 1.17.3

jobs:
  docker-compose:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v1

    - name: Set up Docker Compose
      run: sudo apt-get update && sudo apt-get install -y docker-compose

    - name: Run Docker Compose
      run: |
        docker-compose up
        docker-compose ps
    - name: Display Docker Compose logs
      run: docker-compose logs

    - name: Clean up Docker resources
      if: always()
      run: |
        docker-compose down --rmi all --volumes --remove-orphans
        docker system prune -a -f --volumes